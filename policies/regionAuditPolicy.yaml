# policies/regionAuditPolicy.yaml
name: "Audit resources in allowed regions"
properties:
  displayName: "Audit resources in allowed regions"
  policyType: Custom
  mode: All
  description: "This policy audits resources that are deployed in non-allowed regions."
  metadata:
    category: "General"
  parameters:
    allowedRegions:
      type: Array
      metadata:
        description: "The list of allowed regions."
        displayName: "Allowed Regions"
      allowedValues:
        - "East US"
        - "West US"
        - "Central US"
      defaultValue:
        - "East US"
  policyRule:
    if:
      allOf:
        - field: "location"
          notIn: "[parameters('allowedRegions')]"
    then:
      effect: "audit"
